<script>
    let isHovering = false;
    let isActive = false;
</script>

<div
    x-show="false && (hoverElementId === data.id || activeElementId === data.id)"
    class="absolute inset-0 cursor-pointer transition border border-sky-500"
    :class="{ 'bg-sky-500/20': activeElementId === data.id }"
>
    <div class="absolute -left-px bottom-full font-mono flex py-0.5 px-3 gap-3 text-xs text-white bg-sky-500">
        <span
            class="font-bold italic cursor-default select-none"
            x-text="data.type"
        ></span>
        <span
            x-show="data.hidden || data.readonly"
            x-text="data.hidden ? '[Hidden]' : data.readonly ? '[Readonly]' : ''"
            class="opacity-80"
        ></span>
    </div>
    <div
        x-data="{ }"
        class="absolute -right-px bottom-full flex gap-1"
    >
        <div>
            <button class="w-5 h-5 p-1 cursor-pointer transition bg-sky-500 text-white hover:bg-sky-600">
                <svg class="fill-current [fill-rule:evenodd] [clip-rule:evenodd]">
                    <use href="#copy-icon" />
                </svg>
            </button>
        </div>
        <div x-data="{ deleteDialogOpen: false }">
            <button
                class="w-5 h-5 p-1 cursor-pointer transition relative bg-sky-500 text-white hover:bg-sky-600"
                @click="deleteDialogOpen = true"
            >
                <svg class="aspect-square fill-current">
                    <use href="#delete-icon" />
                </svg>
            </button>
            <div
                x-show="deleteDialogOpen"
                x-transition
                class="grid gap-4 items-center w-max p-4 absolute top-0 -right-0.5 z-50 text-sm shadow-md rounded-md bg-white border border-neutral-200 dark:bg-aux-dark dark:border-aux-dark"
                @click.window.outside="deleteDialogOpen = false;"
                @keyup.window.escape.prevent="deleteDialogOpen = false"
            >
                <h1>Are you sure you want to delete this field?</h1>
                <div class="flex gap-2 justify-self-end">
                    <button
                        @click.self="remove(data.id); deleteDialogOpen = false;"
                        class="px-3 py-1.5 rounded transition-all text-white bg-rose-500 hover:bg-rose-600 outline-rose-300/60 dark:bg-opacity-80 dark:hover:bg-opacity-70"
                    >
                        Delete
                    </button>
                    <button
                        @click="deleteDialogOpen = false;"
                        class="px-3 py-1.5 rounded border transition-all border-neutral-200 text-neutral-600 hover:bg-neutral-100 dark:text-white/80 dark:border-[#555] dark:hover:text-white/90 dark:hover:bg-[#3e3e3e]"
                    >
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div
    x-show="showNewFieldDropZone"
    @dragover="dropTop = true"
    @dragleave="dropTop = false"
    @drop="dropTop = false"
    class="absolute -top-2 left-0 right-0 bottom-1/2 text-xs text-white"
    data-insert-location="beforebegin"
>
    <div
        inert
        x-show="dropTop"
        class="absolute -top-0.5 -right-1 -left-1 flex justify-center h-1 rounded-full bg-sky-500"
    >
        <div class="absolute top-1/2 -translate-y-1/2 px-2 pb-0.5 rounded-full bg-sky-500">Drop Item Here</div>
    </div>
</div>
<div
    x-show="showNewFieldDropZone"
    @dragover="dropBottom = true"
    @dragleave="dropBottom = false"
    @drop="dropBottom = false"
    class="absolute top-1/2 left-0 right-0 -bottom-2 text-xs text-white"
    data-insert-location="afterend"
>
    <div
        inert
        x-show="dropBottom"
        class="absolute -bottom-0.5 -right-1 -left-1 flex justify-center h-1 rounded-full bg-sky-500"
    >
        <div class="absolute top-1/2 -translate-y-1/2 px-2 pb-0.5 rounded-full bg-sky-500">Drop Item Here</div>
    </div>
</div>
