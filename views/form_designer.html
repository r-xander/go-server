{{ define "title" }} Form Designer {{ end }} {{ define "body" }}
<div class="flex flex-col m-4 h-full overflow-hidden dark:bg-base-dark">
    <div class="flex gap-4 h-full w-full overflow-hidden">
        <div class="flex flex-col gap-4 basis-[max(20rem,20%)] overflow-hidden select-none">
            <div class="h-1/2 rounded-md border border-neutral-300 dark:bg-card-dark dark:border-none">
                <h3 class="py-1.5 px-4 rounded-md opacity-80">Fields</h3>
                <div
                    id="action-element-container"
                    class="grid grid-cols-fill-20 auto-rows-max gap-3 py-2 pl-6 pr-1 font-semibold text-indigo-900/70 dark:text-white/70 overflow-y-auto [scrollbar-gutter:stable]"
                >
                    <div
                        class="grid p-2 items-center rounded aspect-square origin-center transition-all duration-100 bg-white border border-neutral-200/65 dark:bg-aux-dark dark:border-none hover:[scale:101%] hover:[translate:0_-2px] hover:[box-shadow:0_3px_3px_-1px_#00000026] hover:text-indigo-900 hover:dark:text-white"
                        draggable="true"
                        dd-template="Text"
                    >
                        <svg
                            viewBox="0 0 14 20"
                            class="justify-self-center fill-current aspect-square w-[max(1.5rem,calc((100%+1rem)/3.33))]"
                        >
                            <path d="M14 2v4h-2v-2h-4v12h2v2h-6v-2h2v-12h-4v2h-2v-4h11z"></path>
                        </svg>
                        <span class="text-center">Text</span>
                    </div>
                    <div
                        class="grid p-2 items-center rounded aspect-square origin-center transition-all duration-100 bg-white border border-neutral-200/65 dark:bg-aux-dark dark:border-none hover:[scale:101%] hover:[translate:0_-2px] hover:[box-shadow:0_3px_3px_-1px_#00000026] hover:text-indigo-900 hover:dark:text-white"
                        draggable="true"
                        dd-template="Number"
                    >
                        <svg
                            viewBox="0 0 1024 1024"
                            class="justify-self-center fill-current aspect-square w-[max(1.5rem,calc((100%+1rem)/3.33))]"
                        >
                            <path
                                d="M872 394c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8H708V152c0-4.4-3.6-8-8-8h-64c-4.4 0-8 3.6-8 8v166H400V152c0-4.4-3.6-8-8-8h-64c-4.4 0-8 3.6-8 8v166H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h168v236H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h168v166c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V706h228v166c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V706h164c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8H708V394h164zM628 630H400V394h228v236z"
                            ></path>
                        </svg>
                        <span class="text-center">Number</span>
                    </div>
                    <div
                        class="grid p-2 items-center rounded aspect-square origin-center transition-all duration-100 bg-white border border-neutral-200/65 dark:bg-aux-dark dark:border-none hover:[scale:101%] hover:[translate:0_-2px] hover:[box-shadow:0_3px_3px_-1px_#00000026] hover:text-indigo-900 hover:dark:text-white"
                        draggable="true"
                        dd-template="Select"
                    >
                        <svg
                            viewBox="0 0 24 24"
                            class="justify-self-center fill-current aspect-square w-[max(1.5rem,calc((100%+1rem)/3.33))]"
                        >
                            <path
                                d="M2.625 6.75C2.625 6.12868 3.12868 5.625 3.75 5.625C4.37132 5.625 4.875 6.12868 4.875 6.75C4.875 7.37132 4.37132 7.875 3.75 7.875C3.12868 7.875 2.625 7.37132 2.625 6.75ZM7.5 6.75C7.5 6.33579 7.83579 6 8.25 6H20.25C20.6642 6 21 6.33579 21 6.75C21 7.16421 20.6642 7.5 20.25 7.5H8.25C7.83579 7.5 7.5 7.16421 7.5 6.75ZM2.625 12C2.625 11.3787 3.12868 10.875 3.75 10.875C4.37132 10.875 4.875 11.3787 4.875 12C4.875 12.6213 4.37132 13.125 3.75 13.125C3.12868 13.125 2.625 12.6213 2.625 12ZM7.5 12C7.5 11.5858 7.83579 11.25 8.25 11.25H20.25C20.6642 11.25 21 11.5858 21 12C21 12.4142 20.6642 12.75 20.25 12.75H8.25C7.83579 12.75 7.5 12.4142 7.5 12ZM2.625 17.25C2.625 16.6287 3.12868 16.125 3.75 16.125C4.37132 16.125 4.875 16.6287 4.875 17.25C4.875 17.8713 4.37132 18.375 3.75 18.375C3.12868 18.375 2.625 17.8713 2.625 17.25ZM7.5 17.25C7.5 16.8358 7.83579 16.5 8.25 16.5H20.25C20.6642 16.5 21 16.8358 21 17.25C21 17.6642 20.6642 18 20.25 18H8.25C7.83579 18 7.5 17.6642 7.5 17.25Z"
                            ></path>
                        </svg>
                        <span class="text-center">Select</span>
                    </div>
                </div>
            </div>
            <div class="h-1/2 rounded-md border border-neutral-300 dark:bg-card-dark dark:border-none">
                <h3 class="py-1.5 px-4 text-sm rounded-md opacity-80">Components</h3>
            </div>
        </div>
        <div
            class="grow grid grid-rows-[max-content_1fr] gap-4 overflow-hidden border border-neutral-300 bg-white dark:bg-base-dark dark:border-none"
        >
            <div
                class="grid grid-cols-[1fr_3fr_1fr] py-2 px-4 sticky top-0 z-10 items-center rounded-md bg-neutral-50 dark:bg-card-dark"
            >
                <div></div>
                <div class="flex gap-2 justify-self-center">
                    <div id="form" class="py-1 px-8 border rounded">Form</div>
                    <div id="Process" class="py-1 px-8 border rounded">Work Flow</div>
                    <div id="form" class="py-1 px-8 border rounded">Form Rules</div>
                </div>
                <div class="justify-self-end">
                    <button
                        id="add-section-button"
                        class="text-sm py-1 px-2 rounded font-semibold text-sky-800/80 hover:text-sky-800 dark:text-sky-400/80 dark:hover:text-sky-400"
                    >
                        +Add Section
                    </button>
                </div>
            </div>
            <div class="py-4 pl-8 pr-4 overflow-auto w-full [scrollbar-gutter:stable]">
                <div id="form_container" class="@container/form relative grid gap-4 max-w-[75rem] mx-auto"></div>
            </div>
        </div>
        <div class="flex flex-col gap-4 basis-[max(20rem,20%)] overflow-hidden">
            <details
                class="p-4 rounded-md border border-neutral-300 dark:bg-card-dark dark:border-none [&_summary_div]:open:rotate-180"
            >
                <summary class="flex font-bold justify-between transition-transform">
                    Form Details
                    <div class="w-6 h-6 flex items-center justify-center scale-y-50 select-none">â–¼</div>
                </summary>
                <div class="p-4 flex gap-8 justify-center">
                    <label class="flex items-center gap-3"><input type="checkbox" />Single Page</label>
                    <label class="flex items-center gap-3"><input type="checkbox" />Tabbed</label>
                </div>
            </details>
            <div class="h-full rounded-md border border-neutral-300 dark:bg-card-dark dark:border-none">
                <h2 class="my-3 font-bold text-center">Details</h2>
                <div id="field-details" class="px-8"></div>
            </div>
        </div>
    </div>
</div>
{{ template "text_field" }} {{ template "number_field" }} {{ template "select_field" }} {{ template "section" }}
<script>
    document.addEventListener("alpine:init", function () {
        let idCache = new Map();

        Alpine.store("formData", {
            formName: "Test Form",
            formAcronym: "tf",
            currentIndex: 1,
            getId(name) {
                if (!idCache.has(name)) {
                    idCache.add(name, 0);
                }

                let index = idCache.get(name);
                return `${name}-${index}`;
            },
        });
    });
</script>
<script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@alpinejs/anchor@3.x.x/dist/cdn.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
<script src="/js/form_designer.js" type="text/javascript" charset="utf-8"></script>
{{ end }} {{ define "field_icons" }}
<div @pointerdown.stop class="flex gap-1">
    <button
        @click="showFieldPanel = true; console.log($el.closest('[form-field]')._x_dataStack[0].fieldData)"
        class="w-6 h-6 p-1 cursor-pointer transition rounded hover:text-emerald-800 hover:bg-emerald-800/20 dark:hover:text-emerald-400 dark:hover:bg-emerald-400/20"
    >
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
                d="M16.8617 4.48667L18.5492 2.79917C19.2814 2.06694 20.4686 2.06694 21.2008 2.79917C21.9331 3.53141 21.9331 4.71859 21.2008 5.45083L10.5822 16.0695C10.0535 16.5981 9.40144 16.9868 8.68489 17.2002L6 18L6.79978 15.3151C7.01323 14.5986 7.40185 13.9465 7.93052 13.4178L16.8617 4.48667ZM16.8617 4.48667L19.5 7.12499M18 14V18.75C18 19.9926 16.9926 21 15.75 21H5.25C4.00736 21 3 19.9926 3 18.75V8.24999C3 7.00735 4.00736 5.99999 5.25 5.99999H10"
                stroke="currentColor"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round"
            />
        </svg>
    </button>
    <button
        class="w-6 h-6 p-1 cursor-pointer transition rounded hover:text-indigo-800 hover:bg-indigo-800/20 dark:hover:text-indigo-400 dark:hover:bg-indigo-400/20"
    >
        <svg viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M1 9.50006C1 10.3285 1.67157 11.0001 2.5 11.0001H4L4 10.0001H2.5C2.22386 10.0001 2 9.7762 2 9.50006L2 2.50006C2 2.22392 2.22386 2.00006 2.5 2.00006L9.5 2.00006C9.77614 2.00006 10 2.22392 10 2.50006V4.00002H5.5C4.67158 4.00002 4 4.67159 4 5.50002V12.5C4 13.3284 4.67158 14 5.5 14H12.5C13.3284 14 14 13.3284 14 12.5V5.50002C14 4.67159 13.3284 4.00002 12.5 4.00002H11V2.50006C11 1.67163 10.3284 1.00006 9.5 1.00006H2.5C1.67157 1.00006 1 1.67163 1 2.50006V9.50006ZM5 5.50002C5 5.22388 5.22386 5.00002 5.5 5.00002H12.5C12.7761 5.00002 13 5.22388 13 5.50002V12.5C13 12.7762 12.7761 13 12.5 13H5.5C5.22386 13 5 12.7762 5 12.5V5.50002Z"
                fill="currentColor"
            />
        </svg>
    </button>
    <button
        class="w-6 h-6 p-1 cursor-pointer transition rounded hover:text-rose-800 hover:bg-rose-800/20 dark:hover:text-rose-400 dark:hover:bg-rose-400/20"
        @click="showDeleteDialog = true"
    >
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" fill="currentColor" fill-rule="evenodd">
            <path
                d="M799.855 166.312c.023.007.043.018.084.059l57.69 57.69c.041.041.052.06.059.084a.118.118 0 0 1 0 .069c-.007.023-.018.042-.059.083L569.926 512l287.703 287.703c.041.04.052.06.059.083a.118.118 0 0 1 0 .07c-.007.022-.018.042-.059.083l-57.69 57.69c-.041.041-.06.052-.084.059a.118.118 0 0 1-.069 0c-.023-.007-.042-.018-.083-.059L512 569.926 224.297 857.629c-.04.041-.06.052-.083.059a.118.118 0 0 1-.07 0c-.022-.007-.042-.018-.083-.059l-57.69-57.69c-.041-.041-.052-.06-.059-.084a.118.118 0 0 1 0-.069c.007-.023.018-.042.059-.083L454.073 512 166.371 224.297c-.041-.04-.052-.06-.059-.083a.118.118 0 0 1 0-.07c.007-.022.018-.042.059-.083l57.69-57.69c.041-.041.06-.052.084-.059a.118.118 0 0 1 .069 0c.023.007.042.018.083.059L512 454.073l287.703-287.702c.04-.041.06-.052.083-.059a.118.118 0 0 1 .07 0Z"
            />
        </svg>
    </button>
</div>
{{ end }} {{ define "text_field" }}
<template id="Text">
    <div
        @click.stop
        x-data="{
            showFieldPanel: false,
            showDeleteDialog: false,
            fieldData: { 
                id: 'tf-0001',
                label: 'Text Input',
                placeholder: null,
                minLenth: null,
                maxLength: null,
                default: null,
                layout: 'inline',
                required: false,
                readonly: false,
                hidden: false 
            },
            getFieldData() {
                return { ...this.fieldData }
            },
            setFieldData(data) {
                this.fieldData = { ...data }
            }
        }"
        id="tf-0001"
        form-field="text"
        class="p-2.5 rounded"
    >
        <div class="flex items-center justify-between mb-1 text-xs text-neutral-500 dark:text-white/60">
            <div class="font-mono flex gap-3">
                <span class="font-bold italic cursor-default select-none">Text Field</span>
                <span
                    x-show="fieldData.hidden || fieldData.readonly"
                    x-text="fieldData.hidden ? '[Hidden]' : fieldData.readonly ? '[Readonly]' : ''"
                    class="text-neutral-400 dark:text-white/40"
                ></span>
            </div>
            {{ template "field_icons" }}
        </div>
        <div
            :class="{ 'opacity-50': fieldData.hidden, 'grid-cols-[3fr_4fr]': fieldData.layout === 'inline'  }"
            class="grid gap-1 w-full items-center"
        >
            <div class="flex gap-1 items-center">
                <label x-text="fieldData.label" class="font-medium select-none" dd-label="Text Field"></label>
                <span x-show="fieldData.required" class="leading-4 font-semibold text-rose-500">*</span>
            </div>
            <input
                :value="fieldData.default ? fieldData.default : ''"
                :placeholder="fieldData.placeholder"
                :readonly="fieldData.readonly || fieldData.hidden"
                @change="$el.value = fieldData.default ? fieldData.default : ''"
                type="text"
            />
        </div>
        <template x-teleport="body">
            <div
                x-data="{ editData: getFieldData() }"
                x-show="showFieldPanel"
                x-cloak
                x-transition.opacity
                class="fixed inset-0 z-50 flex items-center justify-center bg-[#1f232880] dark:bg-[#00000080]"
            >
                <div
                    x-show="showFieldPanel"
                    x-transition
                    class="grid gap-4 w-1/4 min-w-96 px-8 py-6 rounded-md shadow-xl bg-white dark:bg-card-dark"
                >
                    <div class="flex justify-evenly">
                        <label for="required" class="flex items-center gap-2">
                            <input x-model="editData.required" type="checkbox" name="required" id="required" />Required
                        </label>
                        <label for="readonly" class="flex items-center gap-2">
                            <input x-model="editData.readonly" type="checkbox" name="readonly" id="readonly" />Read Only
                        </label>
                        <label for="hidden" class="flex items-center gap-2">
                            <input x-model="editData.hidden" type="checkbox" name="hidden" id="hidden" />Hidden
                        </label>
                    </div>
                    <div class="grid gap-2">
                        <label for="id">ID</label>
                        <input x-model="editData.id" type="text" name="id" id="id" placeholder="id..." />
                    </div>
                    <div class="grid gap-2">
                        <label for="label">Label</label>
                        <input x-model="editData.label" type="text" name="label" id="label" placeholder="label..." />
                    </div>
                    <div class="grid gap-2">
                        <label for="placeholder">Placeholder</label>
                        <input
                            x-model="editData.placeholder"
                            type="text"
                            name="placeholder"
                            id="placeholder"
                            placeholder="placeholder..."
                        />
                    </div>
                    <div class="grid gap-2">
                        <label for="minlength">Minimum Length</label>
                        <input
                            x-model="editData.minLenth"
                            type="text"
                            name="minlength"
                            id="minlength"
                            placeholder="min length..."
                        />
                    </div>
                    <div class="grid gap-2">
                        <label for="maxlength">Minimum Length</label>
                        <input
                            x-model="editData.maxLength"
                            type="text"
                            name="maxlength"
                            id="maxlength"
                            placeholder="max length..."
                        />
                    </div>
                    <div class="grid gap-2">
                        <label for="default">Default</label>
                        <input
                            x-model="editData.default"
                            type="text"
                            name="default"
                            id="default"
                            placeholder="default..."
                        />
                    </div>
                    <div class="grid gap-2">
                        <label for="default">Layout</label>
                        <select
                            x-model="editData.layout"
                            type="text"
                            name="default"
                            id="default"
                            placeholder="default..."
                        >
                            <option value="inline">Inline</option>
                            <option value="block">Block</option>
                        </select>
                    </div>
                    <div class="flex gap-4 justify-end mt-4 text-sm">
                        <button
                            @click="showFieldPanel = false;"
                            class="px-4 py-2 rounded-md border transition-all border-neutral-200 text-neutral-600 hover:bg-neutral-100 dark:text-white/80 dark:bg-aux-dark dark:border-none dark:hover:text-white/90 dark:hover:bg-aux-dark/70"
                        >
                            Cancel
                        </button>
                        <button
                            @click="showFieldPanel = false; setFieldData(editData);"
                            class="px-4 py-2 rounded-md font-semibold tracking-wide transition-all text-white bg-sky-500 hover:bg-sky-600 dark:bg-opacity-80 dark:hover:bg-opacity-70"
                        >
                            Save
                        </button>
                    </div>
                </div>
            </div>
        </template>
        <template x-teleport="body">
            <div
                x-cloak
                x-show="showDeleteDialog"
                x-transition.opacity
                class="fixed inset-0 z-50 flex items-center justify-center bg-[#1f232880] dark:bg-[#00000080]"
            >
                <div
                    x-show="showDeleteDialog"
                    x-transition
                    class="grid gap-4 w-max p-6 rounded-md bg-white dark:bg-card-dark"
                >
                    <h1>Are you sure you want to delete this field?</h1>
                    <div class="flex gap-4 justify-end mt-4 text-sm">
                        <button
                            @click="showDeleteDialog = false;"
                            class="px-4 py-2 rounded-md border transition-all border-neutral-200 text-neutral-600 hover:bg-neutral-100 dark:text-white/80 dark:bg-aux-dark dark:border-none dark:hover:text-white/90 dark:hover:bg-aux-dark/70"
                        >
                            Cancel
                        </button>
                        <button
                            @click.self="showDeleteDialog = false;"
                            class="px-4 py-2 rounded-md font-semibold traking-wide transition-all text-white bg-rose-500 hover:bg-rose-600 dark:bg-opacity-80 dark:hover:bg-opacity-70"
                        >
                            Delete
                        </button>
                    </div>
                </div>
            </div>
        </template>
    </div>
</template>
{{ end }} {{ define "number_field" }}
<template id="Number">
    <div form-field="number" class="p-2.5 rounded">
        <div class="flex items-center justify-between mb-1 text-xs text-black/50 dark:text-white/50">
            <span class="font-mono font-bold italic cursor-default select-none">Number Field</span>
            {{ template "field_icons" }}
        </div>
        <div class="grid @[22rem]/section:grid-cols-[3fr_4fr] w-full items-center">
            <label class="font-medium select-none" for="text" dd-label="Number Field" onclick="event.preventDefault();">
                Number <span class="text-rose-500 font-semibold">*</span>
            </label>
            <input
                class="p-1.5 rounded cursor-default border-neutral-400 dark:bg-aux-dark"
                type="number"
                name="number"
                id="number"
                onmousedown="event.preventDefault();"
                onmouseup="event.preventDefault();"
            />
        </div>
    </div>
</template>
{{ end }} {{ define "select_field" }}
<template id="Select">
    <div form-field="select" class="p-2.5 rounded">
        <div class="flex items-center justify-between mb-1 text-xs text-black/50 dark:text-white/50">
            <span class="font-mono font-bold italic cursor-default select-none">Select Field</span>
            {{ template "field_icons" }}
        </div>
        <div class="grid @[22rem]/section:grid-cols-[3fr_4fr] w-full items-center">
            <label class="font-medium select-none" for="text" dd-label="Select Field" onclick="event.preventDefault();">
                Select <span class="text-rose-500 font-semibold">*</span>
            </label>
            <select
                class="p-1.5 rounded cursor-default border-neutral-400 dark:bg-aux-dark"
                name="select"
                id="select"
                onmousedown="event.preventDefault();"
                onmouseup="event.preventDefault();"
            ></select>
        </div>
    </div>
</template>
{{ end }} {{ define "section" }}
<template id="section-template">
    <div
        section-container
        class="grid gap-3 p-3 rounded-md ring-1 ring-gray-900/5 shadow-md bg-white dark:bg-card-dark"
    >
        <div class="flex items-center justify-between mb-1">
            <h2 data-section-title>Section 1</h2>
            {{ template "field_icons" }}
        </div>
        <div class="grid grid-cols-1 min-h-28 @[35rem]/form:grid-cols-2 gap-4">
            <div
                class="@container/section grid auto-rows-max min-w-64 p-3 gap-3 border border-dashed border-yellow-600 rounded-md"
                data-section
            ></div>
            <div
                class="@container/section grid auto-rows-max min-w-64 p-3 gap-3 border border-dashed border-yellow-600 rounded-md"
                data-section
            ></div>
        </div>
    </div>
</template>
{{ end }}
